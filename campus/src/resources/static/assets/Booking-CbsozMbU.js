import{_ as M}from"./images2-DJjKTlpM.js";import{a as _}from"./axios-Cm0UX6qg.js";import{u as $}from"./index-BiQEVG5M.js";import{r as h,a as x,o as d,b as c,d as l,t as r,F as y,h as E,f as p,w as f,i as C,n as G,u as b,k,E as w,l as S,m as j}from"./index-yeZGxvQv.js";const F="data:image/svg+xml,%3c?xml%20version='1.0'%20standalone='no'?%3e%3c!DOCTYPE%20svg%20PUBLIC%20'-//W3C//DTD%20SVG%201.1//EN'%20'http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd'%3e%3csvg%20t='1712409529815'%20class='icon'%20viewBox='0%200%201024%201024'%20version='1.1'%20xmlns='http://www.w3.org/2000/svg'%20p-id='5779'%20xmlns:xlink='http://www.w3.org/1999/xlink'%20width='128'%20height='128'%3e%3cpath%20d='M512%20512m-448%200a448%20448%200%201%200%20896%200%20448%20448%200%201%200-896%200Z'%20fill='%234CAF50'%20p-id='5780'%3e%3c/path%3e%3cpath%20d='M738.133333%20311.466667L448%20601.6l-119.466667-119.466667-59.733333%2059.733334%20179.2%20179.2%20349.866667-349.866667z'%20fill='%23CCFF90'%20p-id='5781'%3e%3c/path%3e%3c/svg%3e",z="data:image/svg+xml,%3c?xml%20version='1.0'%20standalone='no'?%3e%3c!DOCTYPE%20svg%20PUBLIC%20'-//W3C//DTD%20SVG%201.1//EN'%20'http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd'%3e%3csvg%20t='1712409469531'%20class='icon'%20viewBox='0%200%201024%201024'%20version='1.1'%20xmlns='http://www.w3.org/2000/svg'%20p-id='5617'%20xmlns:xlink='http://www.w3.org/1999/xlink'%20width='128'%20height='128'%3e%3cpath%20d='M512%200C229.216%200%200%20229.248%200%20512c0%20282.784%20229.216%20512%20512%20512%20282.752%200%20512-229.216%20512-512%200-282.752-229.248-512-512-512z%20m292.608%20357.024l-320%20384c-12.128%2014.56-30.08%2023.008-49.024%2023.072h-0.128a63.936%2063.936%200%200%201-48.992-22.88l-167.52-199.488a64%2064%200%201%201%2097.952-82.368l118.336%20140.96%20271.04-325.248a64.032%2064.032%200%200%201%2098.336%2081.952z'%20fill='%23575757'%20p-id='5618'%3e%3c/path%3e%3c/svg%3e",O={class:"max-w-[80%] mx-auto"},L=C('<div class="mx-auto h-2"></div><div class="mx-auto max-w-[80%] bg-white"><div class="flex justify-center py-6 px-6"><img class="w-full min-h-10" src="'+M+'" alt=""></div></div><div class="mx-auto h-2"></div>',3),P={class:"mx-auto max-w-[80%] bg-white"},U=l("div",{class:"flex flex-col justify-center px-6"},[l("span",{class:"w-fit text-4xl font-sans leading-relaxed text-transparent bg-clip-text bg-gradient-to-r to-emerald-600 from-sky-400"},"预约入校")],-1),A={class:"flex flex-col justify-center px-6"},I={class:"flex min-h-screen justify-center overflow-hidden py-6 sm:py-12"},K={class:"mx-auto max-w-screen-xl px-4 w-full"},W={class:"grid w-full gap-3"},Z={class:"w-full"},q={class:"p-4 bg-white rounded-lg border shadow-md sm:p-8"},H={class:"flex justify-between items-center mb-4"},J={class:"text-xl font-bold leading-none text-gray-900"},Q={class:"flow-root"},R={role:"list",class:"divide-y divide-gray-200"},X=["onClick"],ee={class:"flex items-center space-x-4 cursor-pointer"},te={class:"flex-shrink-0"},se=["src"],le=["src"],ae={class:"flex-1 min-w-0"},oe={class:"text-sm font-medium text-gray-900 truncate"},ie={key:0,class:"text-sm text-gray-300 truncate"},ne={key:1,class:"text-sm text-gray-300 truncate"},de={class:"inline-flex items-center text-base font-semibold text-gray-900"},ce=l("div",{class:"h-5"},null,-1),re={class:""},ue=l("div",{class:"text-gray-700"},"选择其他的日期",-1),me=C('<div class="mx-auto h-5"></div><div class="mx-auto max-w-[80%] bg-white"><div class="mx-auto w-full max-w-screen-xl"><div class="px-4 py-6 bg-gray-100 md:flex md:items-center md:justify-between"><span class="text-sm text-gray-500 sm:text-center">© 2024 <a href="#">校园日预约购票系统</a></span></div></div></div>',2),ve={class:"dialog-footer"},we={__name:"Booking",setup(he){const u=h(!1),m=h([]),D=$(),n=h("2024-06-15"),v=h(""),g=o=>{const t=new Date(o),s=t.getFullYear(),a=String(t.getMonth()+1).padStart(2,"0"),e=String(t.getDate()).padStart(2,"0");return`${s}-${a}-${e}`};_.get("/api/auth/getGroup?date=2024-06-15").then(o=>{if(o.data.code===200200){const t=o.data.data,s=new Array(6).fill(0),a=[];for(let e=0;e<5;e++){if(t[e].timeSlot===void 0||t[e].timeSlot===null||!t[e]){s[e]=0;continue}s[t[e].timeSlot]=t[e].number}console.log(s);for(let e=1;e<=5;e++)e===1?a.push({label:"10:00-11:30",value:s[e]}):e===2?a.push({label:"11:30-13:00",value:s[e]}):e===3?a.push({label:"13:00-14:30",value:s[e]}):e===4?a.push({label:"14:30-16:00",value:s[e]}):e===5&&a.push({label:"16:00-17:30",value:s[e]});m.value=a}});const V=()=>{console.log("init 被执行"),_.get("/api/auth/getGroup?date=2024-06-15").then(o=>{if(o.data.code===200200){const t=o.data.data,s=new Array(6).fill(0),a=[];for(let e=0;e<5;e++){if(t[e].timeSlot===void 0||t[e].timeSlot===null||!t[e]){s[e]=0;continue}s[t[e].timeSlot]=t[e].number}console.log(s);for(let e=1;e<=5;e++)e===1?a.push({label:"10:00-11:30",value:s[e]}):e===2?a.push({label:"11:30-13:00",value:s[e]}):e===3?a.push({label:"13:00-14:30",value:s[e]}):e===4?a.push({label:"14:30-16:00",value:s[e]}):e===5&&a.push({label:"16:00-17:30",value:s[e]});m.value=a}})},T=o=>{if(o.value>=1e3){w.alert("预约已满","提示",{confirmButtonText:"确定",type:"warning"});return}v.value=o.label,u.value=!0},B=()=>{const[o,t]=v.value.split("-");_.post(`/api/auth/booking/${D.userInfo.id}?starTime=${o}&endTime=${t}&date=${n.value}`,{date:n.value,timeSlot:v.value}).then(s=>{s.data.code===200200?(w.alert("预约成功","提示",{type:"success",message:S("div",{class:"flex justify-center p-4"},[S("img",{src:s.data.data.imageBase64,alt:"预约成功"})])}),j.success("预约成功"),V()):w.alert("预约失败","提示",{type:"error"})})},N=o=>g(o)<g(new Date)||g(o)!=="2024-06-15",Y=()=>{console.log(n.value)};return(o,t)=>{const s=x("el-date-picker"),a=x("el-button"),e=x("el-dialog");return d(),c(y,null,[l("div",O,[L,l("div",P,[U,l("div",A,[l("div",I,[l("div",K,[l("div",W,[l("div",Z,[l("div",q,[l("div",H,[l("h3",J,r(n.value)+" 预约入校",1)]),l("div",Q,[l("ul",R,[(d(!0),c(y,null,E(m.value,i=>(d(),c("li",{class:G(["py-3 sm:py-4 hover:bg-gray-200 px-2",i===m.value.length?"timeSlotNumber":""]),key:i,onClick:pe=>T(i)},[l("div",ee,[l("div",te,[i.value<1e3&&n.value==="2024-06-15"?(d(),c("img",{key:0,class:"w-8 h-8 rounded-full",src:b(F),alt:"Neil image"},null,8,se)):(d(),c("img",{key:1,class:"w-8 h-8 rounded-full",src:b(z),alt:"Neil image"},null,8,le))]),l("div",ae,[l("p",oe,r(i.label),1),i.value<1e3&&n.value==="2024-06-15"?(d(),c("p",ie," 点我立即预约 ")):(d(),c("p",ne," 预约未开启哦 "))]),l("div",de,r(i.value)+" / 1000 ",1)])],10,X))),128))])])])])]),ce,l("div",re,[ue,p(s,{onChange:Y,modelValue:n.value,"onUpdate:modelValue":t[0]||(t[0]=i=>n.value=i),type:"date",format:"YYYY-MM-DD","disabled-date":N,"value-format":"YYYY-MM-DD",placeholder:"选择日期",size:"large"},null,8,["modelValue"])])])])])]),me]),p(e,{modelValue:u.value,"onUpdate:modelValue":t[2]||(t[2]=i=>u.value=i),title:"提示框",width:"500"},{footer:f(()=>[l("div",ve,[p(a,{onClick:t[1]||(t[1]=i=>u.value=!1)},{default:f(()=>[k("Cancel")]),_:1}),p(a,{type:"primary",onClick:B},{default:f(()=>[k(" Confirm ")]),_:1})])]),default:f(()=>[l("span",null,"确定预约 "+r(n.value)+"日 "+r(v.value)+"段",1)]),_:1},8,["modelValue"])],64)}}};export{we as default};
